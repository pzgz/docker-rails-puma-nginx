# Fail2Ban aggressive SSH filter
# Matches various SSH authentication failures and suspicious activities

[Definition]

# Option: failregex
# Notes: regex to match the password failures messages in the logfile
# Values: TEXT

failregex = ^\s*Invalid user .* from <HOST> port .*
            ^.*Failed password for .* from <HOST> port .* ssh2$
            ^.*Failed password for invalid user .* from <HOST> port .* ssh2$
            ^.*Failed publickey for .* from <HOST> port .* ssh2$
            ^.*Connection closed by <HOST> port .* \[preauth\]$
            ^.*Connection reset by <HOST> port .* \[preauth\]$
            ^.*Did not receive identification string from <HOST>$
            ^.*User .+ from <HOST> not allowed because not listed in AllowUsers$
            ^.*User .+ from <HOST> not allowed because listed in DenyUsers$
            ^.*User .+ from <HOST> not allowed because not in any group$
            ^.*User .+ from <HOST> not allowed because a group is listed in DenyGroups$
            ^.*User .+ from <HOST> not allowed because none of user's groups are listed in AllowGroups$
            ^.*Unable to negotiate with <HOST> port .*: no matching .* found$
            ^.*Unable to negotiate a key exchange method with <HOST>$
            ^.*authentication failure; .* rhost=<HOST>.*$
            ^.*POSSIBLE BREAK-IN ATTEMPT!.*from <HOST>$
            ^.*refused connect from .* \(<HOST>\)$
            ^.*Received disconnect from <HOST>.*: .*: Auth fail$
            ^.*Disconnecting: Too many authentication failures for .* from <HOST>$
            ^.*error: maximum authentication attempts exceeded for .* from <HOST> port .* ssh2 \[preauth\]$
            ^.*Postponed publickey for .* from <HOST> port .* ssh2 \[preauth\]$
            ^.*Connection from <HOST> port .* on .* port .* rdomain .*$

# Option: ignoreregex
# Notes: regex to ignore. If this regex matches, the line is ignored.
# Values: TEXT

ignoreregex =

# Option: journalmatch
# Notes: for systemd/journald backend
journalmatch = _SYSTEMD_UNIT=sshd.service + _COMM=sshd

# Author: Docker Rails Setup