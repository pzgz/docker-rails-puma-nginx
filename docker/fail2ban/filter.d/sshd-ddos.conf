# Fail2Ban filter for SSH DDoS attacks
# Detects rapid connection attempts that might indicate DDoS

[Definition]

# Option: failregex
# Notes: regex to match connection attempts indicating possible DDoS
# Values: TEXT

failregex = ^.*sshd\[\d+\]: Connection from <HOST> port .*$
            ^.*sshd\[\d+\]: Received disconnect from <HOST> port .*:.*: disconnected by user$
            ^.*sshd\[\d+\]: Connection closed by <HOST> port .*$
            ^.*sshd\[\d+\]: Connection reset by <HOST> port .*$

# Option: ignoreregex
# Notes: regex to ignore. If this regex matches, the line is ignored.
# Values: TEXT

ignoreregex = ^.*sshd\[\d+\]: Connection from .* port .* rdomain

# Option: journalmatch
# Notes: for systemd/journald backend
journalmatch = _SYSTEMD_UNIT=sshd.service + _COMM=sshd

# Author: Docker Rails Setup